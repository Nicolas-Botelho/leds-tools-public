"use strict";(self.webpackChunkdocumentacao_leds_tools=self.webpackChunkdocumentacao_leds_tools||[]).push([[2115],{6907:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>o,toc:()=>d});var s=i(4848),r=i(8453);const t={},c="Clean Architecture Csharp",o={id:"spark/sparklib_advanced/backend/generated_arch/Csharp_Clean",title:"Clean Architecture Csharp",description:"This document describes the backend structure of the Moranguinho project, based on Clean Architecture principles. The modular and layered organization promotes separation of concerns, testability, maintainability, and scalability.",source:"@site/docs/spark/5_sparklib_advanced/4_backend/4_generated_arch/4_Csharp_Clean.md",sourceDirName:"spark/5_sparklib_advanced/4_backend/4_generated_arch",slug:"/spark/sparklib_advanced/backend/generated_arch/Csharp_Clean",permalink:"/leds-tools-public/spark/sparklib_advanced/backend/generated_arch/Csharp_Clean",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{},sidebar:"spark",previous:{title:"Spark Compiler Artifact Map",permalink:"/leds-tools-public/spark/sparklib_advanced/backend/artifact_map"},next:{title:"Python Architecture",permalink:"/leds-tools-public/spark/sparklib_advanced/backend/generated_arch/Python"}},a={},d=[{value:"Layered Architecture",id:"layered-architecture",level:2},{value:"Domain Layer \u2014 <code>Moranguinho.Domain</code>",id:"domain-layer--moranguinhodomain",level:3},{value:"<code>Entities/</code> \u2014 Domain Entities",id:"entities--domain-entities",level:4},{value:"<code>Enums/</code> \u2014 Enumerations",id:"enums--enumerations",level:4},{value:"<code>Interfaces/</code> \u2014 Repository/Service Contracts",id:"interfaces--repositoryservice-contracts",level:4},{value:"<code>Validation/</code> \u2014 Validation Rules",id:"validation--validation-rules",level:4},{value:"<code>Common/</code> \u2014 Abstractions and Utilities",id:"common--abstractions-and-utilities",level:4},{value:"Application Layer \u2014 <code>Moranguinho.Application</code>",id:"application-layer--moranguinhoapplication",level:3},{value:"<code>UseCase/</code> \u2014 Use Cases",id:"usecase--use-cases",level:4},{value:"<code>Services/</code> \u2014 Application Services",id:"services--application-services",level:4},{value:"<code>DTOs/</code> \u2014 Data Transfer Objects",id:"dtos--data-transfer-objects",level:4},{value:"<code>Mappers/</code> \u2014 Object Converters",id:"mappers--object-converters",level:4},{value:"<code>Interfaces/</code> \u2014 Infrastructure Contracts",id:"interfaces--infrastructure-contracts",level:4},{value:"<code>Security/</code> \u2014 Security Abstractions",id:"security--security-abstractions",level:4},{value:"<code>Configuration/ServiceExtensions.cs</code>",id:"configurationserviceextensionscs",level:4},{value:"Infrastructure Layer \u2014 <code>Moranguinho.Infrastructure</code>",id:"infrastructure-layer--moranguinhoinfrastructure",level:3},{value:"<code>Context/AppDbContext.cs</code>",id:"contextappdbcontextcs",level:4},{value:"<code>EntitiesConfiguration/</code>",id:"entitiesconfiguration",level:4},{value:"<code>Repositories/</code>",id:"repositories",level:4},{value:"<code>Security/</code>",id:"security",level:4},{value:"<code>ServiceExtensions.cs</code>",id:"serviceextensionscs",level:4},{value:"Presentation Layer \u2014 <code>Moranguinho.WebAPI</code>",id:"presentation-layer--moranguinhowebapi",level:3},{value:"<code>Controllers/</code>",id:"controllers",level:4},{value:"<code>Extensions/</code>",id:"extensions",level:4},{value:"<code>Program.cs</code>",id:"programcs",level:4},{value:"<code>appsettings.json</code>",id:"appsettingsjson",level:4},{value:"<code>Scripts/</code>",id:"scripts",level:4},{value:"Testing Layer \u2014 <code>Moranguinho.Domain.Test</code> and <code>Moranguinho.Infrastructure.Test</code>",id:"testing-layer--moranguinhodomaintest-and-moranguinhoinfrastructuretest",level:3},{value:"<code>Moranguinho.Domain.Test</code>",id:"moranguinhodomaintest",level:4},{value:"<code>Moranguinho.Infrastructure.Test</code>",id:"moranguinhoinfrastructuretest",level:4},{value:". References",id:"-references",level:2},{value:". Improvement Points",id:"-improvement-points",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"clean-architecture-csharp",children:"Clean Architecture Csharp"})}),"\n",(0,s.jsx)(n.p,{children:"This document describes the backend structure of the Moranguinho project, based on Clean Architecture principles. The modular and layered organization promotes separation of concerns, testability, maintainability, and scalability."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"layered-architecture",children:"Layered Architecture"}),"\n",(0,s.jsx)(n.p,{children:"The project follows Clean Architecture principles, with independent layers that isolate business rules, application logic, infrastructure, and user interface. Each layer only depends on the one below it, enabling low coupling and high cohesion."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.h3,{id:"domain-layer--moranguinhodomain",children:["Domain Layer \u2014 ",(0,s.jsx)(n.code,{children:"Moranguinho.Domain"})]}),"\n",(0,s.jsx)(n.p,{children:"This layer represents the core domain of the system, containing entities, business rules, and fundamental contracts."}),"\n",(0,s.jsxs)(n.h4,{id:"entities--domain-entities",children:[(0,s.jsx)(n.code,{children:"Entities/"})," \u2014 Domain Entities"]}),"\n",(0,s.jsxs)(n.p,{children:["Contains core entities like ",(0,s.jsx)(n.code,{children:"Agricultor"}),", ",(0,s.jsx)(n.code,{children:"Propriedade"}),", etc. Each entity encapsulates specific business behavior such as CPF validation or property area constraints."]}),"\n",(0,s.jsxs)(n.h4,{id:"enums--enumerations",children:[(0,s.jsx)(n.code,{children:"Enums/"})," \u2014 Enumerations"]}),"\n",(0,s.jsxs)(n.p,{children:["Defines fixed types used in the domain, contains ",(0,s.jsx)(n.code,{children:"baseEnum.cs"}),"."]}),"\n",(0,s.jsxs)(n.h4,{id:"interfaces--repositoryservice-contracts",children:[(0,s.jsx)(n.code,{children:"Interfaces/"})," \u2014 Repository/Service Contracts"]}),"\n",(0,s.jsxs)(n.p,{children:["Defines interfaces like ",(0,s.jsx)(n.code,{children:"IAgricultorRepository"}),", ",(0,s.jsx)(n.code,{children:"IValidadorPropriedade"}),", enabling dependency inversion and isolated testing."]}),"\n",(0,s.jsxs)(n.h4,{id:"validation--validation-rules",children:[(0,s.jsx)(n.code,{children:"Validation/"})," \u2014 Validation Rules"]}),"\n",(0,s.jsx)(n.p,{children:"Contains specific validation rules applied directly to entities or value objects."}),"\n",(0,s.jsxs)(n.h4,{id:"common--abstractions-and-utilities",children:[(0,s.jsx)(n.code,{children:"Common/"})," \u2014 Abstractions and Utilities"]}),"\n",(0,s.jsxs)(n.p,{children:["Base classes like ",(0,s.jsx)(n.code,{children:"BaseEntity"}),", can contain abstractions and utilities."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.h3,{id:"application-layer--moranguinhoapplication",children:["Application Layer \u2014 ",(0,s.jsx)(n.code,{children:"Moranguinho.Application"})]}),"\n",(0,s.jsx)(n.p,{children:"Responsible for orchestrating system use cases and bridging presentation and domain layers."}),"\n",(0,s.jsxs)(n.h4,{id:"usecase--use-cases",children:[(0,s.jsx)(n.code,{children:"UseCase/"})," \u2014 Use Cases"]}),"\n",(0,s.jsxs)(n.p,{children:["Implements application processes like ",(0,s.jsx)(n.code,{children:"CriarAgricultor"}),", ",(0,s.jsx)(n.code,{children:"BuscarPropriedadePorId"}),", etc. Receives DTOs from the API and interacts with the domain and repositories. Example: ",(0,s.jsx)(n.code,{children:"BaseCase.cs"}),"."]}),"\n",(0,s.jsxs)(n.h4,{id:"services--application-services",children:[(0,s.jsx)(n.code,{children:"Services/"})," \u2014 Application Services"]}),"\n",(0,s.jsxs)(n.p,{children:["Auxiliary services used by use cases, such as productivity calculations or mapping utilities. Example: ",(0,s.jsx)(n.code,{children:"BaseService.cs"}),", ",(0,s.jsx)(n.code,{children:"AgricultorService.cs"}),"."]}),"\n",(0,s.jsxs)(n.h4,{id:"dtos--data-transfer-objects",children:[(0,s.jsx)(n.code,{children:"DTOs/"})," \u2014 Data Transfer Objects"]}),"\n",(0,s.jsxs)(n.p,{children:["Input and output objects for the application. Example folders: ",(0,s.jsx)(n.code,{children:"Request/"}),", ",(0,s.jsx)(n.code,{children:"Response/"}),", and ",(0,s.jsx)(n.code,{children:"Common/"}),". Files: ",(0,s.jsx)(n.code,{children:"AgricultorRequest.cs"}),", ",(0,s.jsx)(n.code,{children:"PropriedadeResponse.cs"}),", etc."]}),"\n",(0,s.jsxs)(n.h4,{id:"mappers--object-converters",children:[(0,s.jsx)(n.code,{children:"Mappers/"})," \u2014 Object Converters"]}),"\n",(0,s.jsxs)(n.p,{children:["Converts between domain entities and DTOs. Manual mapping used in files like ",(0,s.jsx)(n.code,{children:"AgricultorMapper.cs"}),", ",(0,s.jsx)(n.code,{children:"PropriedadeMapper.cs"}),"."]}),"\n",(0,s.jsxs)(n.h4,{id:"interfaces--infrastructure-contracts",children:[(0,s.jsx)(n.code,{children:"Interfaces/"})," \u2014 Infrastructure Contracts"]}),"\n",(0,s.jsx)(n.p,{children:"Interfaces for services such as email sending, authentication, and repositories. Implemented in the Infrastructure layer."}),"\n",(0,s.jsxs)(n.h4,{id:"security--security-abstractions",children:[(0,s.jsx)(n.code,{children:"Security/"})," \u2014 Security Abstractions"]}),"\n",(0,s.jsx)(n.p,{children:"Rules and contracts for authentication/authorization."}),"\n",(0,s.jsx)(n.h4,{id:"configurationserviceextensionscs",children:(0,s.jsx)(n.code,{children:"Configuration/ServiceExtensions.cs"})}),"\n",(0,s.jsx)(n.p,{children:"Registers all application services and configurations in the DI container."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.h3,{id:"infrastructure-layer--moranguinhoinfrastructure",children:["Infrastructure Layer \u2014 ",(0,s.jsx)(n.code,{children:"Moranguinho.Infrastructure"})]}),"\n",(0,s.jsx)(n.p,{children:"Contains concrete implementations of services and repositories, integrating with external systems like databases, security, etc."}),"\n",(0,s.jsx)(n.h4,{id:"contextappdbcontextcs",children:(0,s.jsx)(n.code,{children:"Context/AppDbContext.cs"})}),"\n",(0,s.jsx)(n.p,{children:"EF Core DbContext implementation responsible for database access and entity mappings."}),"\n",(0,s.jsx)(n.h4,{id:"entitiesconfiguration",children:(0,s.jsx)(n.code,{children:"EntitiesConfiguration/"})}),"\n",(0,s.jsxs)(n.p,{children:["Fluent API configuration for database mapping. Example: ",(0,s.jsx)(n.code,{children:"AgricultorConfiguration.cs"}),", ",(0,s.jsx)(n.code,{children:"PropriedadeConfiguration.cs"}),"."]}),"\n",(0,s.jsx)(n.h4,{id:"repositories",children:(0,s.jsx)(n.code,{children:"Repositories/"})}),"\n",(0,s.jsxs)(n.p,{children:["Implements repositories defined in the domain. Examples: ",(0,s.jsx)(n.code,{children:"AgricultorRepository.cs"}),", ",(0,s.jsx)(n.code,{children:"PropriedadeRepository.cs"}),", and base implementations in ",(0,s.jsx)(n.code,{children:"Common/"}),"."]}),"\n",(0,s.jsx)(n.h4,{id:"security",children:(0,s.jsx)(n.code,{children:"Security/"})}),"\n",(0,s.jsxs)(n.p,{children:["Concrete implementations for security concerns, such as ",(0,s.jsx)(n.code,{children:"UserRepository.cs"}),", ",(0,s.jsx)(n.code,{children:"RoleRepository.cs"})," under ",(0,s.jsx)(n.code,{children:"Security/Repositories/"}),"."]}),"\n",(0,s.jsx)(n.h4,{id:"serviceextensionscs",children:(0,s.jsx)(n.code,{children:"ServiceExtensions.cs"})}),"\n",(0,s.jsx)(n.p,{children:"Registers infrastructure-level services into the DI container."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.h3,{id:"presentation-layer--moranguinhowebapi",children:["Presentation Layer \u2014 ",(0,s.jsx)(n.code,{children:"Moranguinho.WebAPI"})]}),"\n",(0,s.jsx)(n.p,{children:"The system's HTTP entry point, where requests arrive and are translated into application commands."}),"\n",(0,s.jsx)(n.h4,{id:"controllers",children:(0,s.jsx)(n.code,{children:"Controllers/"})}),"\n",(0,s.jsxs)(n.p,{children:["Exposes API endpoints like ",(0,s.jsx)(n.code,{children:"POST /agricultores"}),", ",(0,s.jsx)(n.code,{children:"GET /propriedades"}),". Controllers: ",(0,s.jsx)(n.code,{children:"AgricultorController.cs"}),", ",(0,s.jsx)(n.code,{children:"PropriedadeController.cs"}),"."]}),"\n",(0,s.jsx)(n.h4,{id:"extensions",children:(0,s.jsx)(n.code,{children:"Extensions/"})}),"\n",(0,s.jsxs)(n.p,{children:["Configuration for middleware, CORS, Swagger, authentication, etc. Files include ",(0,s.jsx)(n.code,{children:"JwtExtension.cs"}),", ",(0,s.jsx)(n.code,{children:"CorsPolicy.cs"}),", ",(0,s.jsx)(n.code,{children:"OData.cs"}),"."]}),"\n",(0,s.jsx)(n.h4,{id:"programcs",children:(0,s.jsx)(n.code,{children:"Program.cs"})}),"\n",(0,s.jsx)(n.p,{children:"Application bootstrap file. Initializes the host, configures services, and defines the HTTP pipeline."}),"\n",(0,s.jsx)(n.h4,{id:"appsettingsjson",children:(0,s.jsx)(n.code,{children:"appsettings.json"})}),"\n",(0,s.jsx)(n.p,{children:"Configuration file for database connections, JWT keys, CORS, and API settings."}),"\n",(0,s.jsx)(n.h4,{id:"scripts",children:(0,s.jsx)(n.code,{children:"Scripts/"})}),"\n",(0,s.jsxs)(n.p,{children:["Utility SQL scripts such as ",(0,s.jsx)(n.code,{children:"delete.sql"}),", ",(0,s.jsx)(n.code,{children:"killdatabase.sql"})," for local development or test resets."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.h3,{id:"testing-layer--moranguinhodomaintest-and-moranguinhoinfrastructuretest",children:["Testing Layer \u2014 ",(0,s.jsx)(n.code,{children:"Moranguinho.Domain.Test"})," and ",(0,s.jsx)(n.code,{children:"Moranguinho.Infrastructure.Test"})]}),"\n",(0,s.jsx)(n.p,{children:"Dedicated layers for automated tests."}),"\n",(0,s.jsx)(n.h4,{id:"moranguinhodomaintest",children:(0,s.jsx)(n.code,{children:"Moranguinho.Domain.Test"})}),"\n",(0,s.jsxs)(n.p,{children:["Unit tests for domain entities and business rules. Focused on validation, behavior, and isolated logic. Files: ",(0,s.jsx)(n.code,{children:"AgricultorTest.cs"}),", ",(0,s.jsx)(n.code,{children:"PropriedadeTest.cs"}),"."]}),"\n",(0,s.jsx)(n.h4,{id:"moranguinhoinfrastructuretest",children:(0,s.jsx)(n.code,{children:"Moranguinho.Infrastructure.Test"})}),"\n",(0,s.jsxs)(n.p,{children:["Integration tests for repository behavior using EF InMemory. Files in ",(0,s.jsx)(n.code,{children:"Repositories/"}),": ",(0,s.jsx)(n.code,{children:"AgricultorRepositoryTest.cs"}),", ",(0,s.jsx)(n.code,{children:"PropriedadeRepositoryTest.cs"}),". Includes ",(0,s.jsx)(n.code,{children:"appsettings.json"})," and ",(0,s.jsx)(n.code,{children:"xunit.runner.json"})," for test environment setup."]}),"\n",(0,s.jsx)(n.p,{children:"Testing framework: xUnit."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-references",children:". References"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"http://youtube.com/watch?v=luyGoZa9is4&list=PLJ4k1IC8GhW3GICba2dLmiTZrVPw0SthC&index=7",children:".NET - Usando a Clean Architecture - Jose Carlos Macoratti"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/jasontaylordev/CleanArchitecture",children:"Github CleanArchitecture - jasontaylordev"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/amantinband/clean-architecture",children:"Github Clean Architecture Template - amantinband"})}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-improvement-points",children:". Improvement Points"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Clearer Layer Separation"}),": Ensure distinct responsibilities for each layer, avoiding overlap of concerns between the Application, Domain, and Infrastructure layers."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Use of AutoMapper"}),": Implement AutoMapper or similar libraries to simplify and automate the mapping between domain entities and DTOs, reducing boilerplate code and improving maintainability."]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>c,x:()=>o});var s=i(6540);const r={},t=s.createContext(r);function c(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);